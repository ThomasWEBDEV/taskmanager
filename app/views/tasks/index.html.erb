<div class="fade-in-up">
  <!-- Header de la page -->
  <div class="page-header">
    <h1 class="display-4">
      <i class="fas fa-list-check me-3"></i>
      Toutes mes Tâches
    </h1>
    <p class="subtitle">Vue d'ensemble de toutes vos tâches</p>
  </div>

  <!-- Container de recherche et filtres -->
  <div data-controller="search" 
       data-search-url-value="<%= tasks_path %>"
       class="mb-5">
    
    <!-- Barre de recherche moderne avec temps réel -->
    <div class="row justify-content-center mb-4">
      <div class="col-md-8">
        <div class="glass-card p-3">
          <div class="input-group">
            <span class="input-group-text bg-transparent border-0">
              <i class="fas fa-search text-muted"></i>
            </span>
            <input type="text"
                   class="form-control form-control-lg border-0"
                   placeholder="Rechercher une tâche..."
                   data-search-target="input"
                   data-action="input->search#search"
                   value="<%= params[:search] %>">
            <button class="btn btn-outline-secondary border-0"
                    data-action="click->search#clear"
                    type="button">
              <i class="fas fa-times"></i>
            </button>
            <!-- Spinner de chargement -->
            <div class="input-group-text bg-transparent border-0 d-none" 
                 data-search-target="spinner">
              <div class="spinner-border spinner-border-sm text-primary" role="status">
                <span class="visually-hidden">Recherche...</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filtres rapides -->
    <div class="text-center mb-4">
      <div class="btn-group" role="group">
        <button type="button" 
                class="btn <%= params[:status].blank? ? 'btn-primary' : 'btn-outline-secondary' %>"
                data-action="click->search#filterStatus"
                data-status="">
          <i class="fas fa-list me-1"></i>
          Toutes
        </button>
        <button type="button"
                class="btn <%= params[:status] == 'pending' ? 'btn-warning' : 'btn-outline-warning' %>"
                data-action="click->search#filterStatus"
                data-status="pending">
          <i class="fas fa-clock me-1"></i>
          En cours
        </button>
        <button type="button"
                class="btn <%= params[:status] == 'completed' ? 'btn-success' : 'btn-outline-success' %>"
                data-action="click->search#filterStatus"
                data-status="completed">
          <i class="fas fa-check-circle me-1"></i>
          Terminées
        </button>
      </div>
    </div>

    <!-- Statistiques rapides -->
    <% if @tasks.any? %>
      <div class="row g-3 mb-5">
        <div class="col-md-4">
          <div class="stats-card">
            <i class="fas fa-tasks icon" style="color: #667eea;"></i>
            <h4 data-search-target="count"><%= @tasks.count %></h4>
            <div class="label">Résultats</div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="stats-card">
            <i class="fas fa-check-circle icon" style="color: #84fab0;"></i>
            <h4><%= @tasks.completed.count %></h4>
            <div class="label">Terminées</div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="stats-card">
            <i class="fas fa-exclamation-triangle icon" style="color: #ff9a9e;"></i>
            <h4><%= @tasks.overdue.count %></h4>
            <div class="label">En retard</div>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Résultats de recherche -->
    <div data-search-target="results">
      <%= render "tasks/list", tasks: @tasks %>
    </div>
  </div>
</div>
